---
title: "Olympic Data"
author: "team 010100"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:  
    rmdformats::readthedown:
      toc_float: true
      number_sections: true
      code_folding: hide
      keep_tex: yes
---


```{r setup, echo=FALSE, cache=FALSE}
library(knitr)
library(rmdformats)

## Global options
options(max.print="75", scipen = 999, digits = 3, big.mark=",", warn = -1)
opts_chunk$set(echo=FALSE,
	             cache=TRUE,
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
opts_knit$set(width=75)
```

```{r basicfunct, include=FALSE}
loadPkg = function(x) { if (!require(x,character.only=T, quietly =T)) { install.packages(x,dep=T,repos="http://cran.us.r-project.org"); if(!require(x,character.only=T)) stop("Package not found") } }
```

```{r libraries}
#library(ggplot2)
#require(gridExtra)
#library(kableExtra)
loadPkg("ggplot2")
loadPkg("gridExtra")
loadPkg("kableExtra")
loadPkg("plyr")
```

![](tokyo_2020.png)

# Introduction

Team 010100 are the following members: Obumneke Amadi, Izzy Illari, Lucia Illari, Omar Qusous, and Lydia Teinfalt. You may find our work over on [GitHub](https://github.com/IzzyIllari/DATS6101-Spring2020-IntroDataSci).

With the 2020 Olympics beginning this July in Tokyo we felt that a relevant discussion to have would be `What makes an Olympian`? What can we say about Olympians? Have there been any general trends amongst Olympians? What does the Olympic population look like? These questions are all suited to EDA, and with these questions in mind we went to see if we could find data on Olympians that would be readily available for us to analyze. Eventually our question morphed into the following: **are there any specific characteristics (i.e. age, weight, height, BMI, country of origin) that could be used to describe an Olympian in general?** 

We were able to find a dataset called `120 years of Olympic history: athletes and results` on Kaggle over here: [https://www.kaggle.com/heesoo37/120-years-of-olympic-history-athletes-and-results](https://www.kaggle.com/heesoo37/120-years-of-olympic-history-athletes-and-results). This historical dataset includes all Olympic Games from Athens 1896 to Rio 2016, which was scraped from [https://www.sports-reference.com/](https://www.sports-reference.com/). This data was compiled by a group of Olympic historians and statisticians. All of these individuals are members of the International Society of Olympic Historians (ISOH) and have been working on this project since the late 1990s.

The report is organized as follows:

1. Summary of Dataset
2. Description of Data
3. What are the body types of Olympic Athletes? (BMI Data)
4. Where do Olympians come from? (Geographical Data)
5. GDP Data Goes Here?
6. Are there any common names among Olympians? (Name Data)
7. Have there been any body trends among Olympians over the years? (Trends Over Time)
8. Are Olympic Athletes a certain age? (Age Data)
9. Discussion And Conclusion


# Summary of Dataset

The data looks like the following:

```{r input_data}
athlete_events <- data.frame(read.csv("athlete_events.csv"))
noc_regions <- data.frame(read.csv("noc_regions.csv"))
#summary(athlete_events)
str(athlete_events)
```

The athlete events data has `r ncol(athlete_events)` columns and `r nrow(athlete_events)` rows/entries, for a total of `r ncol(athlete_events)*nrow(athlete_events)` individual data points. In `athelete_events` each row corresponds to an individual athlete competing in an individual Olympic event. The variables are the following:

1. ID: Unique number for each athlete
2. Name: Athlete's name
3. Sex: M or F
4. Age: Integer
5. Height: centimeters
6. Weight: kilograms
7. Team: Team name
8. NOC: National Olympic Committee 3-letter code
9. Games: Year and season
10. Year: Integer
11. Season: Summer or Winter
12. City: Host city
13. Sport
14. Event
15. Medal: Gold, Silver, Bronze, or NA

To prepare our data for EDA we dropped the Olympic event: Art Sculpting. NAs were also removed. 

```{r remove_NAs}
athlete_events_noNA <- na.omit(athlete_events)
data_sport <- split(athlete_events_noNA, athlete_events_noNA$Sport)
```


# Description of Data

We can look at the top events by number of athetes participating in these events. We can show this in a table or in a bar chart.

```{r top_ten, echo=F}
list_sports <- as.data.frame(table(athlete_events_noNA$Sport))[1]
sport_counts <- as.data.frame(table(athlete_events_noNA$Sport))[2]
count_sports_data <- do.call(rbind, Map(data.frame, "sport.names" = list_sports, "sport.counts" = sport_counts))
sort_count_sports_data <- count_sports_data[order(-count_sports_data$sport.counts),]
#sort_count_sports_data[1:11,]

top10 <- sort_count_sports_data[2:11,][1]

count_data <- data.frame("Events"=sort_count_sports_data[1:nrow(sort_count_sports_data)/3,][1], "Counts"=sort_count_sports_data[1:nrow(sort_count_sports_data)/3,][2])
names(count_data) <- c("Events", "Counts")

#mapping = aes( x = reorder(Events, Counts), Events)
#ggplot(data=count_data, aes(x=Events, y=Counts, color=Events)) + 
#  geom_bar(stat="identity") + 
#  theme_minimal() + 
#  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1), 
#        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1), 
#        panel.border = element_rect(colour = "black", fill=NA, size=1)) + 
#  labs(title="Barchart of events with most athletes", x="Event") 

freq_sports <- count(athlete_events_noNA, "Sport")
freq_sports <- freq_sports[order(-freq_sports$freq),]
top_10_sports <- freq_sports[1:15,]
freq_sports[1:15,] %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover")) 

ggplot(data=top_10_sports, aes(x=reorder(Sport, -freq), y=freq, color=Sport, fill=Sport)) +
  geom_bar(aes(y=freq), stat="identity") + 
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1), 
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1), 
        panel.border = element_rect(colour = "black", fill=NA, size=1)) + 
  labs(title="Barchart of top 15 events (determined by number of athletes)", x="Event", y="Number of athletes") 
```

# BMI Data
Body Mass Index (BMI) is used to group individuals into weight categories that may lead to health problems. Olympic athletes represent top physical fitness so we wanted to see if Olympians have healthy weight according to the CDC. 

BMI is calculated using athlete's weight in kilograms divided by the square of their height in meters. The dataset stored height in centimeters so the formula was modified to convert their height to meter. The resulting number can be used to classify athtletes older than 20 into one of these groups: underweight, normal or healthy weight, overweight, and obese. 
```{r bmi_packages}
loadPkg("dplyr")

```

```{r bmi}
#source: CDC https://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html
athletes <- athlete_events_noNA
adult_athletes <- athletes %>% filter(Age>=20)
  
#bmi = weight (kg) / [height (m)]^2
adult_athletes[["BMI"]] <- (adult_athletes$Weight/adult_athletes$Height/adult_athletes$Height) * 10000






```

```{r bmi_02, echo=F}
bmi_table <- data.frame("Weight Category"= c("Underweight","Healthy Weight", "Overweight", "Obese" ), "BMI"= c("Less than 18.5", "Between 18.5 and 24.9", "Between 25 and 29.9", "Greater than 30"))
kable(bmi_table) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
adult_athletes <- adult_athletes  %>% mutate(BMI_Category = case_when(
  adult_athletes $BMI < 18.5 ~ 1,
  adult_athletes $BMI >= 18.5 & adult_athletes $BMI < 25 ~ 2,
  adult_athletes $BMI >= 25 & adult_athletes $BMI < 30 ~ 3,
  TRUE ~ 4
))

#storing weight category, BMI_Category, as a factor
adult_athletes$BMI_Category <- as.factor(adult_athletes$BMI_Category)


```
## BMI Boxplots of Athletes' Height, Weight and Age
```{r hist_height}

#boxplot of Height over BMI Weight Status
ggplot(data=adult_athletes, aes(x=BMI_Category, y=Height, fill=Sex)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1), axis.text.y = element_text(vjust = 1, size = 12, hjust = 1)) + labs(title="Boxplot of Height Over Category", x="BMI") + scale_x_discrete(labels=c("Underweight", "Healthy", "Overweight", "Obese"))  + ylab("Height (cm)")
```
The above chart comparing height against categories show averages between female and male athletes are not equal across the board. It does not matter if the Olympian is underweight or obese, the male athletes are on average taller than the female athletes. For healthy and overweight athletes, there are more outliers in the data than the underweight and obese categories.
```{r weight_hist}

#boxplot of Weight over BMI
ggplot(data=adult_athletes, aes(x=BMI_Category, y=Weight, fill=Sex)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1), axis.text.y = element_text(vjust = 1, size = 12, hjust = 1)) + labs(title="Boxplot of Weight Over Category", x="BMI") + scale_x_discrete(labels=c("Underweight", "Healthy", "Overweight", "Obese")) + ylab("Weight (kg")
```
This chart shows that average weight increases from underweight to obese.  This is what we would expect. There is very little variability in weight for underweight Olympians and much greater variablity in the weight for obese athletes. As we found with height, the male athletes on average weigh more than the female athletes.

```{r age_hist}
#boxplot of Age over BMI
ggplot(data=adult_athletes, aes(x=BMI_Category, y=Age, fill=Sex)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1), axis.text.y = element_text(vjust = 1, size = 12, hjust = 1)) + labs(title="Boxplot of Age Over Category", x="BMI") + scale_x_discrete(labels=c("Underweight", "Healthy", "Overweight", "Obese")) 
```

Average ages are close irrespective of weight category or gender. Notable are the number of outliers in age data for healthy and overweight Olympians.
 
## Boxplot of All Olympic Athletes BMI
```{r popular_events}
medal_athletes <- subset(adult_athletes, Medal == "Gold" | Medal == "Silver" | Medal == "Bronze")


gold_medals <- subset(adult_athletes, Medal == "Gold")
silver_medals <- subset(adult_athletes, Medal == "Silver")
bronze_medals <- subset(adult_athletes, Medal == "Bronze")


#histogram of height broken down by gender
ggplot(adult_athletes, aes(x=BMI, fill=BMI_Category))  + geom_histogram(color="gray7", aes(y=..density..)) + facet_wrap( ~ Sex, ncol=2) + ylab("Relative Frequency") +
scale_fill_discrete(name="", labels=c("Underweight", "Healthy", "Overweight", "Obese")) 

```
The histogram of relative frequency versus BMI of female and male Olympians clearly show that not all athletes have healthy weight according to the CDC.

## Boxplot of BMI vs Sport (Summer)

We wondered about the differences between Olympians who competed in summer versus winter events.

```{r BMI_Summer_Athletes}
#boxplot BMI for Summer athletes
summer_events <- subset(medal_athletes, Season == "Summer")
ggplot(data=summer_events, aes(x=Sport, y=BMI, fill=Sex)) + geom_boxplot() +
geom_hline(yintercept=c(18.5), linetype="dashed", color="green")+
geom_hline(yintercept=c(25), linetype="dashed", color="blue")+
geom_hline(yintercept=c(30), linetype="dashed", color="red")+
theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 9, hjust = 1), axis.text.y = element_text(vjust = 1, size = 9))+
scale_y_continuous(breaks = seq(10, 35,5),limits=c(12, 38))+
scale_color_manual(labels = c("Underweight", "Normal","Overweight"))
```
In the summer events, the boxplots show that athletes in the overweight category competed in basketball, boxing, football, ice hockey, rugby, shooting, tug-of-war, weightlifting, and wrestling. There was great variability in BMI for weightlifters, at the top -- they were considered obese. In In the underweight category were female rhythmic gymnasts and gymnasts.

## Boxplot of BMI vs Sport (Winter)   
```{r BMI_Winter_athletes}
#boxplot BMI for Winter athletes
Winter_events <- subset(medal_athletes, Season == "Winter")
ggplot(data=Winter_events, aes(x=Sport, y=BMI, fill=Sex)) + geom_boxplot() + 
geom_hline(yintercept=c(18.5), linetype="dashed", color="green")+
geom_hline(yintercept=c(25), linetype="dashed", color="blue")+
geom_hline(yintercept=c(30), linetype="dashed", color="red")+
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 9, hjust = 1), axis.text.y = element_text(vjust = 1, size = 9)) +scale_y_continuous(breaks = seq(10, 35,5),limits=c(12, 38))
```
In the winter events, the boxplots showed male athletes in the overweight category competed in alpine sking, bobsleigh, curling, freestyle skiing, ice hockey, luge, and snowboarding. The female figure skaters were in the underweight category. Given that there are not that many events in the winter Olympics but athletes in half of the events are upper end of healthy weight to being overweight, it seems that more Winter Olympians are in the upper end of normal to being overweight. The nature of winter events requiring athletes to be bulkier and bigger in order to be competitive.

## Boxplot of BMI vs Top 10 Events
``` {r bmi_mostmedal}
#boxplot BMI for events with most medal
most_medal_events <- c("Swimming", "Rowing",
"Ice Hockey", "Hockey", "Gymnastics", "Fencing", "Football", "Canoeing", "Basketball", "Wrestling", "Volleyball", "Handball", "Cycling", "Water Polo", "Athletics")
popular_events <- subset(medal_athletes, Sport %in% most_medal_events)


ggplot(data=popular_events, aes(x=Sport, y=BMI, fill=Sex)) + geom_boxplot() +
geom_hline(yintercept=c(18.5), linetype="dashed", color="green")+
geom_hline(yintercept=c(25), linetype="dashed", color="blue")+
geom_hline(yintercept=c(30), linetype="dashed", color="red")+
theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 10, hjust = 1), axis.text.y = element_text(vjust = 1, size = 5)) + 
scale_y_continuous(breaks = seq(10, 35,5),limits=c(12, 38))+
scale_color_manual(labels = c("Underweight", "Normal","Overweight"))
```
The boxplots showing BMI data for top 10 events with the most athletes is easier to read and confirms that for events such as basketball, handball, ice hockey, water polo, and wrestling the male athletes are considered overweight by CDC standards. The lower end of the weight categorization is gymnastics.   



## Gold Medal Athletes BMI

We looked at sporting events in order to learn about summer versus winter athletes and found there are more overweight winter athletes. The events played a strong role in determing the BMI group of the athletes. We wanted to find out winning a medal also show common characeristics betewen athletes. Did Gold/Silver/Bronze medalists have more in common with each irrespective of event? 

The boxplot and histograms showing BMI data for Gold/Silver/Bronze medal winners was relatively normal. 

```{r gold_BMI}
gold_medals <- subset(adult_athletes, Medal == "Gold")
boxplot(gold_medals$BMI, main="Gold Medal Athletes BMI", ylab="BMI", col='gold')

gbmi <- ggplot(gold_medals, aes(x=BMI)) 

#histogram of BMI broken down by gender
gbmi + geom_histogram(color="gold", binwidth = 1, aes(y=..density..)) + xlab("BMI") 

```

## Silver Medal Athletes BMI
```{r silver_BMI}
silver_medals <- subset(adult_athletes, Medal == "Silver")
boxplot(silver_medals$BMI, main="Silver Medal Athletes BMI", ylab="BMI", col='gray')

sbmi <- ggplot(silver_medals, aes(x=BMI)) 

#histogram of 
sbmi + geom_histogram(color="blue", binwidth = 1, aes(y=..density..)) + xlab("BMI") 
```

## Bronze Medal Athletes BMI
```{r bronze_BMI}
bronze_medals <- subset(adult_athletes, Medal == "Bronze")

boxplot(bronze_medals$BMI, main="Bronze Medal Athletes BMI", ylab="BMI", col='brown')

#histogram of height broken down by gender
ggplot(bronze_medals, aes(x=BMI, fill=BMI))  + geom_histogram(color="brown", binwidth = 1, aes(y=..density..)) 

```

We created a scatterplot of height and weight of athletes that competed in the top 10 events to discern groupings based on event but did not find any conclusive visual evidence.
```{r scatter_medal}



ggplot(data=popular_events)+
  geom_point(mapping = aes(x=Weight, y=Height, color=Sport))+
  xlab("Weight (kg)") + ylab("Height (cm)") +
  ggtitle("Scatter Plot of Athletes of Popular Events Height vs Weight")


```

## US Olympic Team 
We've looked at data from the perspective of season, events and medals. Let's focus on US Olympic Team data in table format to see if we can draw any conclusions. 

Gymnasts on the US Olympic team are on the lower spectrum of healthy weight range. Wrestlers are on average second tallest but they have the highest BMI, making them classified as "overweight". 
```{r team_analysis}


US_team <- subset(popular_events,NOC=="USA")
x <- popular_events %>%
  group_by(Sport) %>% summarise_at(c("Height", "Weight", "BMI"), mean, na.rm = TRUE) %>% arrange(Height)
names(x) <- c("Sport", "Height", "Weight", "BMI")

convert_m_fi <- function(xm){
    xm_ft <- xm * 39.3701 / 12
    xm_ft_int <- floor(xm * 39.3701 / 12)
    xm_inch <- round((xm_ft - xm_ft_int) * 12, 1)
    return(paste(xm_ft_int, "ft", xm_inch, "in"))
}
x_metric <- data.frame(x$Sport, round(x$Height/100, digits = 2), round(x$Weight,digits = 2), round(x$BMI, digits = 2))
names(x_metric)<- c("Sport", "Avg Height (m)", "Avg Weight (kg)", "BMI")

#x_imperial <- data.frame(x$Sport, convert_m_fi(x$Height/100), round(x$Weight*2.2046226218,1), round(x$BMI) ) 
#names(x_imperial) <- c("Sport", " Mean Height", " Mean Weight (lbs)", "Mean BMI")


#kable(x_imperial) %>%
  #kable_styling(bootstrap_options = c("striped", "hover"))

kable(x_metric) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```
## T-Intervals 95% confidence

```{r t-intervals}
male_athletes <- subset(adult_athletes, Sex == "M")
female_athletes  <- subset(adult_athletes, Sex == "F")

tinterval.bmi.c95.male = t.test(x=male_athletes$BMI, conf.level=0.95)
tinterval.bmi.c95.female = t.test(x=female_athletes$BMI, conf.level=0.95)

```

Variable |      Gender          | level 0.95 |
---------|----------------------|------------|
BMI      | Sex  = M | [`r format(tinterval.bmi.c95.male$conf.int,digits=5)`] 
BMI     | Sex = F  | [`r format(tinterval.bmi.c95.female$conf.int,digits=5)`]  

## T-Test
```{r t-test}
bmi_ttest <- t.test(BMI~Sex, data=adult_athletes)
```

The p-value being small enough to be considered `r format(bmi_ttest$p.value, digits=5)`, hence used a two-sided test we can reject the null hypothesis that the means of BMI being equal between male and female athletes. The plots indicate that male Olympian athletes' BMI to be greater than female Olympian athletes. Female and male
athletes BMI: `r format(bmi_ttest$estimate)`


Variable |      Gender          | Average |
---------|----------------------|------------|
BMI      | Sex  = F | [`r format(bmi_ttest$estimate[1],digits=3)`] 
BMI     | Sex = M  | [`r format(bmi_ttest$estimate[2],digits=3)`]  

## Anova Test comparing BMI Averages of Athletes From Different Olympic Sporting Events
```{r anova}

anovabmi = aov(BMI ~ Sport, data=popular_events)
summary(anovabmi)
```
The small p-value would confirm that there are significant differences in BMI averages of athletes in each sports which can be confirmed by the plots from sections 4.3-4.4 


# Geographical Data

# GDP Data

# Name Data

# Trends Over Time

We wanted to see the changes in Olympians for the top 10 events (in terms of how many Olympians were recorded for the sport) over the years. Below are the top 10 events:  

```{r over_time, echo=F}
# Swimming
data_Swimming_gender <- split(data_sport$Swimming, data_sport$Swimming$Sex)
data_Swimming_F_year <- split(data_Swimming_gender$F, data_Swimming_gender$F$Year)
data_Swimming_M_year <- split(data_Swimming_gender$"M", data_Swimming_gender$"M"$Year)
years_F_Swimming <- names(data_Swimming_F_year)
years_M_Swimming <- names(data_Swimming_M_year)
mean_years_weight_F_Swimming <- list()
sd_years_weight_F_Swimming <- list()
mean_years_height_F_Swimming <- list()
sd_years_height_F_Swimming <- list()
mean_years_weight_M_Swimming <- list()
sd_years_weight_M_Swimming <- list()
mean_years_height_M_Swimming <- list()
sd_years_height_M_Swimming <- list()
# women data
for (i in 1:length(data_Swimming_F_year)) {
	mean_years_weight_F_Swimming[[i]] <- mean(data_Swimming_F_year[[i]]$Weight)
	sd_years_weight_F_Swimming[[i]] <- sd(data_Swimming_F_year[[i]]$Weight)
	mean_years_height_F_Swimming[[i]] <- mean(data_Swimming_F_year[[i]]$Height)
	sd_years_height_F_Swimming[[i]] <- sd(data_Swimming_F_year[[i]]$Height)
}
# men data
for (i in 1:length(data_Swimming_M_year)) {
	mean_years_weight_M_Swimming[[i]] <- mean(data_Swimming_M_year[[i]]$Weight)
	sd_years_weight_M_Swimming[[i]] <- sd(data_Swimming_M_year[[i]]$Weight)
	mean_years_height_M_Swimming[[i]] <- mean(data_Swimming_M_year[[i]]$Height)
	sd_years_height_M_Swimming[[i]] <- sd(data_Swimming_M_year[[i]]$Height)
}
# make data frames
Swimming_F_data <- do.call(rbind, Map(data.frame, Year = years_F_Swimming, Mean_Weight = mean_years_weight_F_Swimming, StdDev_Weight = sd_years_weight_F_Swimming, Mean_Height = mean_years_height_F_Swimming, StdDev_Height = sd_years_height_F_Swimming))
Swimming_M_data <- do.call(rbind, Map(data.frame, Year = years_M_Swimming, Mean_Weight = mean_years_weight_F_Swimming, StdDev_Weight = sd_years_weight_F_Swimming, Mean_Height = mean_years_height_F_Swimming, StdDev_Height = sd_years_height_F_Swimming))
# Rowing
data_Rowing_gender <- split(data_sport$Rowing, data_sport$Rowing$Sex)
data_Rowing_F_year <- split(data_Rowing_gender$F, data_Rowing_gender$F$Year)
data_Rowing_M_year <- split(data_Rowing_gender$"M", data_Rowing_gender$"M"$Year)
years_F_Rowing <- names(data_Rowing_F_year)
years_M_Rowing <- names(data_Rowing_M_year)
mean_years_weight_F_Rowing <- list()
sd_years_weight_F_Rowing <- list()
mean_years_height_F_Rowing <- list()
sd_years_height_F_Rowing <- list()
mean_years_weight_M_Rowing <- list()
sd_years_weight_M_Rowing <- list()
mean_years_height_M_Rowing <- list()
sd_years_height_M_Rowing <- list()
# women data
for (i in 1:length(data_Rowing_F_year)) {
	mean_years_weight_F_Rowing[[i]] <- mean(data_Rowing_F_year[[i]]$Weight)
	sd_years_weight_F_Rowing[[i]] <- sd(data_Rowing_F_year[[i]]$Weight)
	mean_years_height_F_Rowing[[i]] <- mean(data_Rowing_F_year[[i]]$Height)
	sd_years_height_F_Rowing[[i]] <- sd(data_Rowing_F_year[[i]]$Height)
}
# men data
for (i in 1:length(data_Rowing_M_year)) {
	mean_years_weight_M_Rowing[[i]] <- mean(data_Rowing_M_year[[i]]$Weight)
	sd_years_weight_M_Rowing[[i]] <- sd(data_Rowing_M_year[[i]]$Weight)
	mean_years_height_M_Rowing[[i]] <- mean(data_Rowing_M_year[[i]]$Height)
	sd_years_height_M_Rowing[[i]] <- sd(data_Rowing_M_year[[i]]$Height)
}
# make data frames
Rowing_F_data <- do.call(rbind, Map(data.frame, Year = years_F_Rowing, Mean_Weight = mean_years_weight_F_Rowing, StdDev_Weight = sd_years_weight_F_Rowing, Mean_Height = mean_years_height_F_Rowing, StdDev_Height = sd_years_height_F_Rowing))
Rowing_M_data <- do.call(rbind, Map(data.frame, Year = years_M_Rowing, Mean_Weight = mean_years_weight_F_Rowing, StdDev_Weight = sd_years_weight_F_Rowing, Mean_Height = mean_years_height_F_Rowing, StdDev_Height = sd_years_height_F_Rowing))
# Ice.Hockey
data_Ice.Hockey_gender <- split(data_sport$"Ice Hockey", data_sport$"Ice Hockey"$Sex)
data_Ice.Hockey_F_year <- split(data_Ice.Hockey_gender$F, data_Ice.Hockey_gender$F$Year)
data_Ice.Hockey_M_year <- split(data_Ice.Hockey_gender$"M", data_Ice.Hockey_gender$"M"$Year)
years_F_Ice.Hockey <- names(data_Ice.Hockey_F_year)
years_M_Ice.Hockey <- names(data_Ice.Hockey_M_year)
mean_years_weight_F_Ice.Hockey <- list()
sd_years_weight_F_Ice.Hockey <- list()
mean_years_height_F_Ice.Hockey <- list()
sd_years_height_F_Ice.Hockey <- list()
mean_years_weight_M_Ice.Hockey <- list()
sd_years_weight_M_Ice.Hockey <- list()
mean_years_height_M_Ice.Hockey <- list()
sd_years_height_M_Ice.Hockey <- list()
# women data
for (i in 1:length(data_Ice.Hockey_F_year)) {
	mean_years_weight_F_Ice.Hockey[[i]] <- mean(data_Ice.Hockey_F_year[[i]]$Weight)
	sd_years_weight_F_Ice.Hockey[[i]] <- sd(data_Ice.Hockey_F_year[[i]]$Weight)
	mean_years_height_F_Ice.Hockey[[i]] <- mean(data_Ice.Hockey_F_year[[i]]$Height)
	sd_years_height_F_Ice.Hockey[[i]] <- sd(data_Ice.Hockey_F_year[[i]]$Height)
}
# men data
for (i in 1:length(data_Ice.Hockey_M_year)) {
	mean_years_weight_M_Ice.Hockey[[i]] <- mean(data_Ice.Hockey_M_year[[i]]$Weight)
	sd_years_weight_M_Ice.Hockey[[i]] <- sd(data_Ice.Hockey_M_year[[i]]$Weight)
	mean_years_height_M_Ice.Hockey[[i]] <- mean(data_Ice.Hockey_M_year[[i]]$Height)
	sd_years_height_M_Ice.Hockey[[i]] <- sd(data_Ice.Hockey_M_year[[i]]$Height)
}
# make data frames
Ice.Hockey_F_data <- do.call(rbind, Map(data.frame, Year = years_F_Ice.Hockey, Mean_Weight = mean_years_weight_F_Ice.Hockey, StdDev_Weight = sd_years_weight_F_Ice.Hockey, Mean_Height = mean_years_height_F_Ice.Hockey, StdDev_Height = sd_years_height_F_Ice.Hockey))
Ice.Hockey_M_data <- do.call(rbind, Map(data.frame, Year = years_M_Ice.Hockey, Mean_Weight = mean_years_weight_F_Ice.Hockey, StdDev_Weight = sd_years_weight_F_Ice.Hockey, Mean_Height = mean_years_height_F_Ice.Hockey, StdDev_Height = sd_years_height_F_Ice.Hockey))
# Hockey
data_Hockey_gender <- split(data_sport$Hockey, data_sport$Hockey$Sex)
data_Hockey_F_year <- split(data_Hockey_gender$F, data_Hockey_gender$F$Year)
data_Hockey_M_year <- split(data_Hockey_gender$"M", data_Hockey_gender$"M"$Year)
years_F_Hockey <- names(data_Hockey_F_year)
years_M_Hockey <- names(data_Hockey_M_year)
mean_years_weight_F_Hockey <- list()
sd_years_weight_F_Hockey <- list()
mean_years_height_F_Hockey <- list()
sd_years_height_F_Hockey <- list()
mean_years_weight_M_Hockey <- list()
sd_years_weight_M_Hockey <- list()
mean_years_height_M_Hockey <- list()
sd_years_height_M_Hockey <- list()
# women data
for (i in 1:length(data_Hockey_F_year)) {
	mean_years_weight_F_Hockey[[i]] <- mean(data_Hockey_F_year[[i]]$Weight)
	sd_years_weight_F_Hockey[[i]] <- sd(data_Hockey_F_year[[i]]$Weight)
	mean_years_height_F_Hockey[[i]] <- mean(data_Hockey_F_year[[i]]$Height)
	sd_years_height_F_Hockey[[i]] <- sd(data_Hockey_F_year[[i]]$Height)
}
# men data
for (i in 1:length(data_Hockey_M_year)) {
	mean_years_weight_M_Hockey[[i]] <- mean(data_Hockey_M_year[[i]]$Weight)
	sd_years_weight_M_Hockey[[i]] <- sd(data_Hockey_M_year[[i]]$Weight)
	mean_years_height_M_Hockey[[i]] <- mean(data_Hockey_M_year[[i]]$Height)
	sd_years_height_M_Hockey[[i]] <- sd(data_Hockey_M_year[[i]]$Height)
}
# make data frames
Hockey_F_data <- do.call(rbind, Map(data.frame, Year = years_F_Hockey, Mean_Weight = mean_years_weight_F_Hockey, StdDev_Weight = sd_years_weight_F_Hockey, Mean_Height = mean_years_height_F_Hockey, StdDev_Height = sd_years_height_F_Hockey))
Hockey_M_data <- do.call(rbind, Map(data.frame, Year = years_M_Hockey, Mean_Weight = mean_years_weight_F_Hockey, StdDev_Weight = sd_years_weight_F_Hockey, Mean_Height = mean_years_height_F_Hockey, StdDev_Height = sd_years_height_F_Hockey))
# Gymnastics
data_Gymnastics_gender <- split(data_sport$Gymnastics, data_sport$Gymnastics$Sex)
data_Gymnastics_F_year <- split(data_Gymnastics_gender$F, data_Gymnastics_gender$F$Year)
data_Gymnastics_M_year <- split(data_Gymnastics_gender$"M", data_Gymnastics_gender$"M"$Year)
years_F_Gymnastics <- names(data_Gymnastics_F_year)
years_M_Gymnastics <- names(data_Gymnastics_M_year)
mean_years_weight_F_Gymnastics <- list()
sd_years_weight_F_Gymnastics <- list()
mean_years_height_F_Gymnastics <- list()
sd_years_height_F_Gymnastics <- list()
mean_years_weight_M_Gymnastics <- list()
sd_years_weight_M_Gymnastics <- list()
mean_years_height_M_Gymnastics <- list()
sd_years_height_M_Gymnastics <- list()
# women data
for (i in 1:length(data_Gymnastics_F_year)) {
	mean_years_weight_F_Gymnastics[[i]] <- mean(data_Gymnastics_F_year[[i]]$Weight)
	sd_years_weight_F_Gymnastics[[i]] <- sd(data_Gymnastics_F_year[[i]]$Weight)
	mean_years_height_F_Gymnastics[[i]] <- mean(data_Gymnastics_F_year[[i]]$Height)
	sd_years_height_F_Gymnastics[[i]] <- sd(data_Gymnastics_F_year[[i]]$Height)
}
# men data
for (i in 1:length(data_Gymnastics_M_year)) {
	mean_years_weight_M_Gymnastics[[i]] <- mean(data_Gymnastics_M_year[[i]]$Weight)
	sd_years_weight_M_Gymnastics[[i]] <- sd(data_Gymnastics_M_year[[i]]$Weight)
	mean_years_height_M_Gymnastics[[i]] <- mean(data_Gymnastics_M_year[[i]]$Height)
	sd_years_height_M_Gymnastics[[i]] <- sd(data_Gymnastics_M_year[[i]]$Height)
}
# make data frames
Gymnastics_F_data <- do.call(rbind, Map(data.frame, Year = years_F_Gymnastics, Mean_Weight = mean_years_weight_F_Gymnastics, StdDev_Weight = sd_years_weight_F_Gymnastics, Mean_Height = mean_years_height_F_Gymnastics, StdDev_Height = sd_years_height_F_Gymnastics))
Gymnastics_M_data <- do.call(rbind, Map(data.frame, Year = years_M_Gymnastics, Mean_Weight = mean_years_weight_F_Gymnastics, StdDev_Weight = sd_years_weight_F_Gymnastics, Mean_Height = mean_years_height_F_Gymnastics, StdDev_Height = sd_years_height_F_Gymnastics))
# Fencing
data_Fencing_gender <- split(data_sport$Fencing, data_sport$Fencing$Sex)
data_Fencing_F_year <- split(data_Fencing_gender$F, data_Fencing_gender$F$Year)
data_Fencing_M_year <- split(data_Fencing_gender$"M", data_Fencing_gender$"M"$Year)
years_F_Fencing <- names(data_Fencing_F_year)
years_M_Fencing <- names(data_Fencing_M_year)
mean_years_weight_F_Fencing <- list()
sd_years_weight_F_Fencing <- list()
mean_years_height_F_Fencing <- list()
sd_years_height_F_Fencing <- list()
mean_years_weight_M_Fencing <- list()
sd_years_weight_M_Fencing <- list()
mean_years_height_M_Fencing <- list()
sd_years_height_M_Fencing <- list()
# women data
for (i in 1:length(data_Fencing_F_year)) {
	mean_years_weight_F_Fencing[[i]] <- mean(data_Fencing_F_year[[i]]$Weight)
	sd_years_weight_F_Fencing[[i]] <- sd(data_Fencing_F_year[[i]]$Weight)
	mean_years_height_F_Fencing[[i]] <- mean(data_Fencing_F_year[[i]]$Height)
	sd_years_height_F_Fencing[[i]] <- sd(data_Fencing_F_year[[i]]$Height)
}
# men data
for (i in 1:length(data_Fencing_M_year)) {
	mean_years_weight_M_Fencing[[i]] <- mean(data_Fencing_M_year[[i]]$Weight)
	sd_years_weight_M_Fencing[[i]] <- sd(data_Fencing_M_year[[i]]$Weight)
	mean_years_height_M_Fencing[[i]] <- mean(data_Fencing_M_year[[i]]$Height)
	sd_years_height_M_Fencing[[i]] <- sd(data_Fencing_M_year[[i]]$Height)
}
# make data frames
Fencing_F_data <- do.call(rbind, Map(data.frame, Year = years_F_Fencing, Mean_Weight = mean_years_weight_F_Fencing, StdDev_Weight = sd_years_weight_F_Fencing, Mean_Height = mean_years_height_F_Fencing, StdDev_Height = sd_years_height_F_Fencing))
Fencing_M_data <- do.call(rbind, Map(data.frame, Year = years_M_Fencing, Mean_Weight = mean_years_weight_F_Fencing, StdDev_Weight = sd_years_weight_F_Fencing, Mean_Height = mean_years_height_F_Fencing, StdDev_Height = sd_years_height_F_Fencing))
# Football
data_Football_gender <- split(data_sport$Football, data_sport$Football$Sex)
data_Football_F_year <- split(data_Football_gender$F, data_Football_gender$F$Year)
data_Football_M_year <- split(data_Football_gender$"M", data_Football_gender$"M"$Year)
years_F_Football <- names(data_Football_F_year)
years_M_Football <- names(data_Football_M_year)
mean_years_weight_F_Football <- list()
sd_years_weight_F_Football <- list()
mean_years_height_F_Football <- list()
sd_years_height_F_Football <- list()
mean_years_weight_M_Football <- list()
sd_years_weight_M_Football <- list()
mean_years_height_M_Football <- list()
sd_years_height_M_Football <- list()
# women data
for (i in 1:length(data_Football_F_year)) {
	mean_years_weight_F_Football[[i]] <- mean(data_Football_F_year[[i]]$Weight)
	sd_years_weight_F_Football[[i]] <- sd(data_Football_F_year[[i]]$Weight)
	mean_years_height_F_Football[[i]] <- mean(data_Football_F_year[[i]]$Height)
	sd_years_height_F_Football[[i]] <- sd(data_Football_F_year[[i]]$Height)
}
# men data
for (i in 1:length(data_Football_M_year)) {
	mean_years_weight_M_Football[[i]] <- mean(data_Football_M_year[[i]]$Weight)
	sd_years_weight_M_Football[[i]] <- sd(data_Football_M_year[[i]]$Weight)
	mean_years_height_M_Football[[i]] <- mean(data_Football_M_year[[i]]$Height)
	sd_years_height_M_Football[[i]] <- sd(data_Football_M_year[[i]]$Height)
}
# make data frames
Football_F_data <- do.call(rbind, Map(data.frame, Year = years_F_Football, Mean_Weight = mean_years_weight_F_Football, StdDev_Weight = sd_years_weight_F_Football, Mean_Height = mean_years_height_F_Football, StdDev_Height = sd_years_height_F_Football))
Football_M_data <- do.call(rbind, Map(data.frame, Year = years_M_Football, Mean_Weight = mean_years_weight_F_Football, StdDev_Weight = sd_years_weight_F_Football, Mean_Height = mean_years_height_F_Football, StdDev_Height = sd_years_height_F_Football))
# Canoeing
data_Canoeing_gender <- split(data_sport$Canoeing, data_sport$Canoeing$Sex)
data_Canoeing_F_year <- split(data_Canoeing_gender$F, data_Canoeing_gender$F$Year)
data_Canoeing_M_year <- split(data_Canoeing_gender$"M", data_Canoeing_gender$"M"$Year)
years_F_Canoeing <- names(data_Canoeing_F_year)
years_M_Canoeing <- names(data_Canoeing_M_year)
mean_years_weight_F_Canoeing <- list()
sd_years_weight_F_Canoeing <- list()
mean_years_height_F_Canoeing <- list()
sd_years_height_F_Canoeing <- list()
mean_years_weight_M_Canoeing <- list()
sd_years_weight_M_Canoeing <- list()
mean_years_height_M_Canoeing <- list()
sd_years_height_M_Canoeing <- list()
# women data
for (i in 1:length(data_Canoeing_F_year)) {
	mean_years_weight_F_Canoeing[[i]] <- mean(data_Canoeing_F_year[[i]]$Weight)
	sd_years_weight_F_Canoeing[[i]] <- sd(data_Canoeing_F_year[[i]]$Weight)
	mean_years_height_F_Canoeing[[i]] <- mean(data_Canoeing_F_year[[i]]$Height)
	sd_years_height_F_Canoeing[[i]] <- sd(data_Canoeing_F_year[[i]]$Height)
}
# men data
for (i in 1:length(data_Canoeing_M_year)) {
	mean_years_weight_M_Canoeing[[i]] <- mean(data_Canoeing_M_year[[i]]$Weight)
	sd_years_weight_M_Canoeing[[i]] <- sd(data_Canoeing_M_year[[i]]$Weight)
	mean_years_height_M_Canoeing[[i]] <- mean(data_Canoeing_M_year[[i]]$Height)
	sd_years_height_M_Canoeing[[i]] <- sd(data_Canoeing_M_year[[i]]$Height)
}
# make data frames
Canoeing_F_data <- do.call(rbind, Map(data.frame, Year = years_F_Canoeing, Mean_Weight = mean_years_weight_F_Canoeing, StdDev_Weight = sd_years_weight_F_Canoeing, Mean_Height = mean_years_height_F_Canoeing, StdDev_Height = sd_years_height_F_Canoeing))
Canoeing_M_data <- do.call(rbind, Map(data.frame, Year = years_M_Canoeing, Mean_Weight = mean_years_weight_F_Canoeing, StdDev_Weight = sd_years_weight_F_Canoeing, Mean_Height = mean_years_height_F_Canoeing, StdDev_Height = sd_years_height_F_Canoeing))
# Basketball
data_Basketball_gender <- split(data_sport$Basketball, data_sport$Basketball$Sex)
data_Basketball_F_year <- split(data_Basketball_gender$F, data_Basketball_gender$F$Year)
data_Basketball_M_year <- split(data_Basketball_gender$"M", data_Basketball_gender$"M"$Year)
years_F_Basketball <- names(data_Basketball_F_year)
years_M_Basketball <- names(data_Basketball_M_year)
mean_years_weight_F_Basketball <- list()
sd_years_weight_F_Basketball <- list()
mean_years_height_F_Basketball <- list()
sd_years_height_F_Basketball <- list()
mean_years_weight_M_Basketball <- list()
sd_years_weight_M_Basketball <- list()
mean_years_height_M_Basketball <- list()
sd_years_height_M_Basketball <- list()
# women data
for (i in 1:length(data_Basketball_F_year)) {
	mean_years_weight_F_Basketball[[i]] <- mean(data_Basketball_F_year[[i]]$Weight)
	sd_years_weight_F_Basketball[[i]] <- sd(data_Basketball_F_year[[i]]$Weight)
	mean_years_height_F_Basketball[[i]] <- mean(data_Basketball_F_year[[i]]$Height)
	sd_years_height_F_Basketball[[i]] <- sd(data_Basketball_F_year[[i]]$Height)
}
# men data
for (i in 1:length(data_Basketball_M_year)) {
	mean_years_weight_M_Basketball[[i]] <- mean(data_Basketball_M_year[[i]]$Weight)
	sd_years_weight_M_Basketball[[i]] <- sd(data_Basketball_M_year[[i]]$Weight)
	mean_years_height_M_Basketball[[i]] <- mean(data_Basketball_M_year[[i]]$Height)
	sd_years_height_M_Basketball[[i]] <- sd(data_Basketball_M_year[[i]]$Height)
}
# make data frames
Basketball_F_data <- do.call(rbind, Map(data.frame, Year = years_F_Basketball, Mean_Weight = mean_years_weight_F_Basketball, StdDev_Weight = sd_years_weight_F_Basketball, Mean_Height = mean_years_height_F_Basketball, StdDev_Height = sd_years_height_F_Basketball))
Basketball_M_data <- do.call(rbind, Map(data.frame, Year = years_M_Basketball, Mean_Weight = mean_years_weight_F_Basketball, StdDev_Weight = sd_years_weight_F_Basketball, Mean_Height = mean_years_height_F_Basketball, StdDev_Height = sd_years_height_F_Basketball))
# Wrestling
data_Wrestling_gender <- split(data_sport$Wrestling, data_sport$Wrestling$Sex)
data_Wrestling_F_year <- split(data_Wrestling_gender$F, data_Wrestling_gender$F$Year)
data_Wrestling_M_year <- split(data_Wrestling_gender$"M", data_Wrestling_gender$"M"$Year)
years_F_Wrestling <- names(data_Wrestling_F_year)
years_M_Wrestling <- names(data_Wrestling_M_year)
mean_years_weight_F_Wrestling <- list()
sd_years_weight_F_Wrestling <- list()
mean_years_height_F_Wrestling <- list()
sd_years_height_F_Wrestling <- list()
mean_years_weight_M_Wrestling <- list()
sd_years_weight_M_Wrestling <- list()
mean_years_height_M_Wrestling <- list()
sd_years_height_M_Wrestling <- list()
# women data
for (i in 1:length(data_Wrestling_F_year)) {
	mean_years_weight_F_Wrestling[[i]] <- mean(data_Wrestling_F_year[[i]]$Weight)
	sd_years_weight_F_Wrestling[[i]] <- sd(data_Wrestling_F_year[[i]]$Weight)
	mean_years_height_F_Wrestling[[i]] <- mean(data_Wrestling_F_year[[i]]$Height)
	sd_years_height_F_Wrestling[[i]] <- sd(data_Wrestling_F_year[[i]]$Height)
}
# men data
for (i in 1:length(data_Wrestling_M_year)) {
	mean_years_weight_M_Wrestling[[i]] <- mean(data_Wrestling_M_year[[i]]$Weight)
	sd_years_weight_M_Wrestling[[i]] <- sd(data_Wrestling_M_year[[i]]$Weight)
	mean_years_height_M_Wrestling[[i]] <- mean(data_Wrestling_M_year[[i]]$Height)
	sd_years_height_M_Wrestling[[i]] <- sd(data_Wrestling_M_year[[i]]$Height)
}
# make data frames
Wrestling_F_data <- do.call(rbind, Map(data.frame, Year = years_F_Wrestling, Mean_Weight = mean_years_weight_F_Wrestling, StdDev_Weight = sd_years_weight_F_Wrestling, Mean_Height = mean_years_height_F_Wrestling, StdDev_Height = sd_years_height_F_Wrestling))
Wrestling_M_data <- do.call(rbind, Map(data.frame, Year = years_M_Wrestling, Mean_Weight = mean_years_weight_F_Wrestling, StdDev_Weight = sd_years_weight_F_Wrestling, Mean_Height = mean_years_height_F_Wrestling, StdDev_Height = sd_years_height_F_Wrestling))
```

```{r printlegend}
#plot.new()
#legend("center", c("Swimming", "Rowing", "Ice Hockey", "Hockey", "Gymnastics", 
#                   "Fencing", "Football", "Canoeing", "Basketball", "Wrestling"),
#       fill=c("black", "red", "pink", "coral", "orange", "gold", "green", 
#              "lightseagreen", "blue", "purple")
       #xpd=TRUE,
       #horiz=TRUE
#       )
#box()
sort_count_sports_data[2:11,] %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
  #column_spec(1, bold = T, border_right = T) %>%
  row_spec(1, background = "black", color = "white") %>%
  row_spec(2, background = "red", color = "black") %>%
  row_spec(3, background = "pink", color = "black") %>%
  row_spec(4, background = "coral", color = "black") %>%
  row_spec(5, background = "orange", color = "black") %>%
  row_spec(6, background = "gold", color = "black") %>%
  row_spec(7, background = "green", color = "black") %>%
  row_spec(8, background = "lightseagreen", color = "black") %>%
  row_spec(9, background = "blue", color = "white") %>%
  row_spec(10, background = "purple", color = "white") 
```

```{r testggplot, echo=F}
# women weight
women_weight_plot <- ggplot(Swimming_F_data, aes(x=Year, y=Mean_Weight, group=1)) +
  geom_line(color='black') + geom_line(data = Rowing_F_data, colour='red') +
  geom_line(data = Ice.Hockey_F_data, colour='pink') + 
  geom_line(data = Hockey_F_data, colour='coral') + 
  geom_line(data = Gymnastics_F_data, colour='orange') + 
  geom_line(data = Fencing_F_data, colour='gold') + 
  geom_line(data = Football_F_data, colour='green') + 
  geom_line(data = Canoeing_F_data, colour='lightseagreen') + 
  geom_line(data = Basketball_F_data, colour='blue') + 
  geom_line(data = Wrestling_F_data, colour='purple') + 
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 10, hjust = 1),
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1), 
        panel.border = element_rect(colour = "black", fill=NA, size=1)) + 
  labs(title="Scatterplot of Olympic Women's \nAverage Weights [kg] Over Time", 
       x="year", y="weight [kg]", color = "Legend") 
# women height
women_height_plot <- ggplot(Swimming_F_data, aes(x=Year, y=Mean_Height, group=1)) + 
  geom_line(color="black") + 
  labs(title="Scatterplot of Olympic Women's \nAverage Heights [cm] Over Time", 
       x="year", y="height [cm]") + 
  geom_line(data = Rowing_F_data, colour='red') + geom_line(data = Ice.Hockey_F_data, colour='pink') + 
  geom_line(data = Hockey_F_data, colour='coral') + 
  geom_line(data = Gymnastics_F_data, colour='orange') + 
  geom_line(data = Fencing_F_data, colour='gold') + 
  geom_line(data = Football_F_data, colour='green') + 
  geom_line(data = Canoeing_F_data, colour='lightseagreen') + 
  geom_line(data = Basketball_F_data, colour='blue') + 
  geom_line(data = Wrestling_F_data, colour='purple') + 
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 10, hjust = 1), 
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1), 
        panel.border = element_rect(colour = "black", fill=NA, size=1))
# men weight
men_weight_plot <- ggplot(Swimming_M_data, aes(x=Year, y=Mean_Weight, group=1)) + 
  geom_line(color="black") + 
  labs(title="Scatterplot of Olympic Men's \nAverage Weights [kg] Over Time", 
       x="year", y="weight [kg]") + 
  geom_line(data = Rowing_M_data, colour='red') + 
  geom_line(data = Ice.Hockey_M_data, colour='pink') + 
  geom_line(data = Hockey_M_data, colour='coral') + 
  geom_line(data = Gymnastics_M_data, colour='orange') + 
  geom_line(data = Fencing_M_data, colour='gold') + 
  geom_line(data = Football_M_data, colour='green') + 
  geom_line(data = Canoeing_M_data, colour='lightseagreen') + 
  geom_line(data = Basketball_M_data, colour='blue') + 
  geom_line(data = Wrestling_M_data, colour='purple') + 
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 8, hjust = 1), 
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1), 
        panel.border = element_rect(colour = "black", fill=NA, size=1))
# men height
men_height_plot <- ggplot(Swimming_M_data, aes(x=Year, y=Mean_Height, group=1)) + 
  geom_line(color="black") + 
  labs(title="Scatterplot of Olympic Men's \nAverage Heights [cm] Over Time", 
       x="year", y="height [cm]") + 
  geom_line(data = Rowing_M_data, colour='red') + 
  geom_line(data = Ice.Hockey_M_data, colour='pink') + 
  geom_line(data = Hockey_M_data, colour='coral') + 
  geom_line(data = Gymnastics_M_data, colour='orange') + 
  geom_line(data = Fencing_M_data, colour='gold') + 
  geom_line(data = Football_M_data, colour='green') + 
  geom_line(data = Canoeing_M_data, colour='lightseagreen') + 
  geom_line(data = Basketball_M_data, colour='blue') + 
  geom_line(data = Wrestling_M_data, colour='purple') + 
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 8, hjust = 1), 
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1), 
        panel.border = element_rect(colour = "black", fill=NA, size=1))
# plots
grid.arrange(women_weight_plot, men_weight_plot, women_height_plot, men_height_plot,
                    #labels = c("A", "B", "C", "D"),
                    ncol = 2, nrow = 2)
```

It seems that in general events like rowing or basketball have been trending towards larger and larger athletes (in terms of both weight and height) whereas events like Gymnastics skews in the completely opposite direction, favoring smaller and smaller athletes. The Wrestling event data is a bit misleading---we have taken the averages per Olympic game year, and if we were to look at the Wrestling data by itself we would see clear categories for weight and height. This is due to the nature of the sport, and its weight classes. This is why in the men's data it looks like the data for the Wrestling is a constant straight line. It appears that way because there the following weight classes at the Olympics: Freestyle weight classes (12): Men’s 57kg, Men’s 65kg, Men’s 74kg, Men’s 86kg, Men’s 97kg, Men’s 125kg, Women’s 50kg, Women’s 53kg, Women’s 57kg, Women’s 62kg, Women’s 68kg, Women’s 76kg; and then Greco-Roman weight classes (6): Men’s 60kg, Men’s 67kg, Men’s 77kg, Men’s 87kg, Men’s 97kg, Men’s 130kg. 

What we can also use this over time data for is to see trends during "decades". We can overlay the data for the decades ontop of each other on a histogram, or we could use boxplots where we've made a decade into a "rank"/factorial data type. 

```{r decades}
#data_year <- split(athlete_events_noNA, athlete_events_noNA$Year)
list_year <- list(1896, 1900, 1904, 1906, 1908, 1912, 1920, 1924, 1928, 1932, 1936, 1948, 1952, 1956, 1960, 1964, 1968, 1972, 1976, 1980, 1984, 1988, 1992, 1994, 1996, 1998, 2000, 2002, 2004, 2006, 2008, 2010, 2012, 2014, 2016)
decade_list <- vector(mode = "list", length = length(athlete_events_noNA))
#get indexes of decade decade
index1890s <- which(athlete_events_noNA$Year >= 1890 & athlete_events_noNA$Year < 1900)
index1900s <- which(athlete_events_noNA$Year >= 1900 & athlete_events_noNA$Year < 1910)
index1910s <- which(athlete_events_noNA$Year >= 1910 & athlete_events_noNA$Year < 1920)
index1920s <- which(athlete_events_noNA$Year >= 1920 & athlete_events_noNA$Year < 1930)
index1930s <- which(athlete_events_noNA$Year >= 1930 & athlete_events_noNA$Year < 1940)
index1940s <- which(athlete_events_noNA$Year >= 1940 & athlete_events_noNA$Year < 1950)
index1950s <- which(athlete_events_noNA$Year >= 1950 & athlete_events_noNA$Year < 1960)
index1960s <- which(athlete_events_noNA$Year >= 1960 & athlete_events_noNA$Year < 1970)
index1970s <- which(athlete_events_noNA$Year >= 1970 & athlete_events_noNA$Year < 1980)
index1980s <- which(athlete_events_noNA$Year >= 1980 & athlete_events_noNA$Year < 1990)
index1990s <- which(athlete_events_noNA$Year >= 1990 & athlete_events_noNA$Year < 2000)
index2000s <- which(athlete_events_noNA$Year >= 2000 & athlete_events_noNA$Year < 2010)
index2010s <- which(athlete_events_noNA$Year >= 2010 & athlete_events_noNA$Year < 2020)
#fill decade list with decade data
for (i in 1:length(index1890s)) {
  decade_list[index1890s[i]] <- "1890s"
}
for (i in 1:length(index1900s)) {
  decade_list[index1900s[i]] <- "1900s"
}
for (i in 1:length(index1910s)) {
  decade_list[index1910s[i]] <- "1910s"
}
for (i in 1:length(index1920s)) {
  decade_list[index1920s[i]] <- "1920s"
}
for (i in 1:length(index1930s)) {
  decade_list[index1930s[i]] <- "1930s"
}
for (i in 1:length(index1940s)) {
  decade_list[index1940s[i]] <- "1940s"
}
for (i in 1:length(index1950s)) {
  decade_list[index1950s[i]] <- "1950s"
}
for (i in 1:length(index1960s)) {
  decade_list[index1960s[i]] <- "1960s"
}
for (i in 1:length(index1970s)) {
  decade_list[index1970s[i]] <- "1970s"
}
for (i in 1:length(index1980s)) {
  decade_list[index1980s[i]] <- "1980s"
}
for (i in 1:length(index1990s)) {
  decade_list[index1990s[i]] <- "1990s"
}
for (i in 1:length(index2000s)) {
  decade_list[index2000s[i]] <- "2000s"
}
for (i in 1:length(index2010s)) {
  decade_list[index2010s[i]] <- "2010s"
}
#make dataframe with decade_list
df <- data.frame(matrix(unlist(decade_list), nrow=length(decade_list), byrow=T))
names(df)[1] <- "Decade"
#combine two dataframes
athlete_events_noNA <- cbind(athlete_events_noNA, df)
#make into a factor
athlete_events_noNA$Decade <- as.factor(athlete_events_noNA$Decade)
```

Now that I've created a new comlumn `Decade` in the dataframe, I can make histograms or boxplots of the `Weight` and `Height` and group by `Decade`. 

```{r plot_by_decade}
#separate data by decade
df1890s <- athlete_events_noNA[athlete_events_noNA$Decade == "1890s", ]
df1900s <- athlete_events_noNA[athlete_events_noNA$Decade == "1900s", ]
df1910s <- athlete_events_noNA[athlete_events_noNA$Decade == "1910s", ]
df1920s <- athlete_events_noNA[athlete_events_noNA$Decade == "1920s", ]
df1930s <- athlete_events_noNA[athlete_events_noNA$Decade == "1930s", ]
df1940s <- athlete_events_noNA[athlete_events_noNA$Decade == "1940s", ]
df1950s <- athlete_events_noNA[athlete_events_noNA$Decade == "1950s", ]
df1960s <- athlete_events_noNA[athlete_events_noNA$Decade == "1960s", ]
df1970s <- athlete_events_noNA[athlete_events_noNA$Decade == "1970s", ]
df1980s <- athlete_events_noNA[athlete_events_noNA$Decade == "1980s", ]
df1990s <- athlete_events_noNA[athlete_events_noNA$Decade == "1990s", ]
df2000s <- athlete_events_noNA[athlete_events_noNA$Decade == "2000s", ]
df2010s <- athlete_events_noNA[athlete_events_noNA$Decade == "2010s", ]
#make plots
mean_weight <- mean(athlete_events_noNA$Weight)
mean_height <- mean(athlete_events_noNA$Height)

hist_decade_weight <- ggplot(athlete_events_noNA, aes(x=Weight, color=Decade)) +
  geom_histogram(aes(y=..density..), binwidth = 3) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1),
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1), 
        panel.border = element_rect(colour = "black", fill=NA, size=1)) + 
  labs(title="Histogram of \nOlympic Weights [kg] \nOver The Decades", 
       x="weight [kg]") 

hist_decade_height <- ggplot(athlete_events_noNA, aes(x=Height, color=Decade)) +
  geom_histogram(aes(y=..density..), binwidth = 2) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1),
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1), 
        panel.border = element_rect(colour = "black", fill=NA, size=1)) + 
  labs(title="Histogram of \nOlympic Heights [kg] \nOver The Decades", 
       x="height [cm]") 

hist_decade_weight2 <- ggplot(athlete_events_noNA, aes(x=Weight, color=Decade)) + 
  geom_histogram(aes(y=..density..), position="identity") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1), 
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1)) + 
  labs(title="Histogram of \nOlympic Weights [kg] \nOver The Decades", x="weight [kg]") 

hist_decade_height2 <- ggplot(athlete_events_noNA, aes(x=Height, color=Decade)) + 
  geom_histogram(aes(y=..density..), position="identity") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1), 
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1)) + 
  labs(title="Histogram of \nOlympic Heights [kg] \nOver The Decades", x="height [cm]") 

boxplot_decade_weight <- ggplot(data=athlete_events_noNA, aes(x=Decade, y=Weight, fill=Decade)) + 
  geom_boxplot() + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1), 
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1), 
        panel.border = element_rect(colour = "black", fill=NA, size=1)) + 
  labs(title="Boxplot of \nOlympic Weights [kg] \nOver The Decades", x="Decade") 

boxplot_decade_height <- ggplot(data=athlete_events_noNA, aes(x=Decade, y=Height, fill=Decade)) + 
  geom_boxplot() + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 12, hjust = 1), 
        axis.text.y = element_text(vjust = 1, size = 12, hjust = 1), 
        panel.border = element_rect(colour = "black", fill=NA, size=1)) + 
  labs(title="Boxplot of \nOlympic Heights [kg] \nOver The Decades", x="Decade") 

qqplot_decade_weight <- ggplot(athlete_events_noNA, 
            aes(sample = Weight, color=Decade)) + 
  stat_qq() + 
  stat_qq_line() + 
  labs(title="Normal Q-Q plot of \nOlympic Weights [kg] \nOver The Decades") 

qqplot_decade_height <- ggplot(athlete_events_noNA, 
                               aes(sample = Height, color=Decade)) + 
  stat_qq() + 
  stat_qq_line() + 
  labs(title="Normal Q-Q plot of \nOlympic Heights [cm] \nOver The Decades") 

#show plots
#grid.arrange(hist_decade_weight, boxplot_decade_weight, hist_decade_height, boxplot_decade_height, ncol = 2, nrow = 2)
grid.arrange(hist_decade_weight, boxplot_decade_weight, ncol = 2, nrow = 1)
grid.arrange(hist_decade_height, boxplot_decade_height, ncol = 2, nrow = 1)
#grid.arrange(hist_decade_weight2, hist_decade_height2, ncol = 2, nrow = 1)
#grid.arrange(qqplot_decade_weight, qqplot_decade_height, ncol = 2, nrow = 1)
```

We have the boxplots, but we can use ANOVA to test the difference between the means in the weight and height data over the decades. ANOVA testing we have that:

1. Null hypothesis: the means of the different groups are the same
2. Alternative hypothesis: At least one sample mean is not equal to the others.

In one-way ANOVA test, a significant $p$-value indicates that some of the group means are different, but we don’t know which pairs of groups are different. We use a significance level of $\alpha = 0.05$.

```{r anova_testing}
decade_weight <- aov(Weight ~ Decade, data=athlete_events_noNA)
decade_height <- aov(Height ~ Decade, data=athlete_events_noNA)
```

Here is the ANOVA test for the weight data over the decades

```{r anova_weight}
summary(decade_weight)
p_val_weight <- summary(decade_weight)[[1]][["Pr(>F)"]][[1]]
```

We can see that for `aov(Weight ~ Decade, data=athlete_events_noNA)`, we have $p$ = `r formatC(p_val_weight, format = "e", digits = 3)`. The $p$-value here is not significant, which means that over time, the mean weight of the athletes is not significantly different between the decades.

Here is the ANOVA test for the height data over the decades

```{r anova_height}
summary(decade_height) 
p_val_height <- summary(decade_height)[[1]][["Pr(>F)"]][[1]]
```

We can see that for `aov(Height ~ Decade, data=athlete_events_noNA)`, we have $p$ = `r formatC(p_val_height, format = "e", digits = 3)`. The $p$-value here is very significant, which means that over time, the mean height of the athletes is significantly different between the decades.



# Age Data

```{r average_age}
library("tidyverse")
library("data.table")
library(kableExtra)
olympic <- read_csv("athlete_events.csv",
                    col_types = cols(
                      ID = col_character(),
                      Name = col_character(),
                      Sex = col_factor(levels = c("M","F")),
                      Age =  col_integer(),
                      Height = col_double(),
                      Weight = col_double(),
                      Team = col_character(),
                      NOC = col_character(),
                      Games = col_character(),
                      Year = col_integer(),
                      Season = col_factor(levels = c("Summer","Winter")),
                      City = col_character(),
                      Sport = col_character(),
                      Event = col_character(),
                      Medal = col_factor(levels = c("Gold","Silver","Bronze"))
                      )
                    )

medalist <- olympic %>% 
  filter(!is.na(Medal)) 

medalist %>% 
  group_by(Medal) %>% 
  summarise(
    mean = mean(Age, na.rm = TRUE)
  ) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
  column_spec(1, bold = T, border_right = T) %>%
  row_spec(1, background = "gold") %>%
  row_spec(2, background = "darkgray") %>%
  row_spec(3, background = "tomato")
```

It appears that the mean age that an Olympic Medalist wins a medal is around 26 years old. We can also look at the ages of medal-winning athletes separated by the Summer and Winter Games. 

```{r summer_games_ages}
summer_medalist <-
medalist %>% 
  group_by(Year, Season, Medal) %>% 
  filter(Season == "Summer") %>% 
  summarise(
    mean = mean(Age, na.rm = TRUE)
  )

summer_ages <- ggplot(data = summer_medalist, 
       mapping = aes(x = Year, y= mean, group = Medal, color = Medal)) +
  geom_point(size=2) +
  geom_line() +
  labs(title="Average Age of Olympic Medalists \nin the Summer Games", x="year", y="mean age [years]") +
  theme_minimal() +
  theme(panel.border = element_rect(colour = "black", fill=NA, size=1)) +
  scale_color_manual(values=c("goldenrod1", "darkgray", "coral3")) 

medalist_winter <-
  medalist %>% 
  group_by(Year, Season, Medal) %>% 
  filter(Season == "Winter") %>% 
  summarise(
    mean = mean(Age, na.rm = TRUE)
  )

winter_ages <- ggplot(data = medalist_winter, mapping = aes(x= Year, y= mean, group = Medal, color = Medal)) +
  geom_point(size=2) +
  geom_line() +
  labs(title="Average Age of Olympic Medalists \nin the Winter Games", 
       x="year", y="mean age [years]") +
  theme_minimal() +
  theme(panel.border = element_rect(colour = "black", fill=NA, size=1)) +
  scale_color_manual(values=c("goldenrod1", "darkgray", "coral3")) 

grid.arrange(summer_ages, winter_ages, ncol = 2, nrow = 1)
```

From the plots we can see that between WW1 and WW2 the average age of medalists is decreasing, but after WW2 the average age temporarily rose. We see that the age begins to decrease until 1980 but then rises again after 1980. The age seems to plateau in the 2010s. 

It seems that there are fewer peaks and dips in the Winter Games data than in the Summer Games data, where the Winter Athletes seem to have a smaller variance in age. We can look at the Summer and Winter Games together. 

```{r compare_summer_winter}
season_medalist <-
medalist %>% 
  group_by(Season, Year) %>% 
  summarise(
    mean = mean(Age, na.rm = TRUE)
  )

ggplot( data = season_medalist, 
  mapping = aes(x= Year, y= mean, group = Season, color = Season)) +
  geom_point(size=2) +
  geom_line() +
  labs(title="Average Age of Olympic Medalists Separated by Season", 
       x="year", y="mean age [years]") +
  theme_minimal() +
  theme(panel.border = element_rect(colour = "black", fill=NA, size=1)) +
  scale_color_manual(values=c("chocolate1", "cornflowerblue")) 
```

It appears that after the 1950s the athletes at the Winter Games, on average, are older. Both Summer and Winter Games experience an upward trend in ages after the 1980s. 

We can also look at the breakdown of ages between Season and Gender.

```{r age_sex_plots}
summer_medalist_sex <-
  medalist %>%
  filter(Season == "Summer") %>% 
  group_by(Year, Sex) %>% 
    summarise(
    mean = mean(Age, na.rm = TRUE)
  )

summer_ages_gender <- ggplot(data = summer_medalist_sex, 
       mapping = aes(x = Year, y= mean, group = Sex, color = Sex)) +
  geom_point(size=2) +
  geom_line() +
  labs(title="Average Age of Olympic Medalists \nin the Summer Games \nSeparated by Gender",
       x="year", y="mean age [years]") +
  theme_minimal() +
  theme(panel.border = element_rect(colour = "black", fill=NA, size=1))

winter_medalist <-
  medalist %>% 
  group_by(Year, Season, Sex) %>% 
  filter(Season == "Winter") %>% 
  summarise(
    mean = mean(Age, na.rm = TRUE)
  )

winter_ages_gender <- ggplot(data = winter_medalist, 
       mapping = aes(x = Year, y= mean, group = Sex, color = Sex)) +
  geom_point(size=2) +
  geom_line() +
  labs(title="Average Age of Olympic Medalists \nin the Winter Games \nSeparated by Gender",
       x="year", y="mean age [years]") +
  theme_minimal() +
  theme(panel.border = element_rect(colour = "black", fill=NA, size=1))

grid.arrange(summer_ages_gender, winter_ages_gender, ncol = 2, nrow = 1)
```

When we look at the medal-winning athletes during the Summer Games by gender we see that in general men get medals at older ages than women do. Just as with the Summer Games we see that, on average, male athletes tend to be older than female athletes.


# Discussion & Conclusion
